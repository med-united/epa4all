server:
  http_listen_port: 3102

positions:
  filename: /tmp/positions.yaml

clients:
  - url: http://host.docker.internal:3100/loki/api/v1/push

scrape_configs:
  - job_name: epa4all
    static_configs:
    - targets:
        - localhost
      labels:
        job: epa4all
        __path__: /tmp/epa4all.log
    pipeline_stages:
      - json:
          expressions:
            time: timestamp
            loggerName: loggerName
            message: message
            thread: threadName
            level: level
#            exception: stackTrace
            client: servicehealth_client_id
#            mdc: mdc
#      - json:
#          expressions:
#            vauSession: vauSession
#            iccsn: iccsn
#            konnektor: konnektor
#          source: mdc
#      - template:
#          source: vauSession
#          template: '{{ if eq .vauSession nil }}n/a{{ else }}{{ .vauSession }}{{ end }}'
#      - template:
#          source: iccsn
#          template: '{{ if eq .iccsn nil }}n/a{{ else }}{{ .iccsn }}{{ end }}'
#      - template:
#          source: konnektor
#          template: '{{ if eq .konnektor nil }}n/a{{ else }}{{ .konnektor }}{{ end }}'
#      - template:
#          source: exception
#          template: '{{ if eq .exception nil }}n/a{{ else }}{{ .exception }}{{ end }}'
      - labels:
          loggerName:
          message:
          thread:
          level:
          client:
#          exception:
#          vauSession:
#          iccsn:
#          konnektor:
      - timestamp:
          source: time
          format: RFC3339
          location: Europe/Berlin
      - labeldrop:
          - time